// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model users {
    id                  String @id @default(cuid(2))
    username            String @unique
    password            String
    active              Boolean @default(true)
    owner               String
    created             DateTime @default(now())
    updated             DateTime @default(now()) @updatedAt
}

model roles {
    id                  String @id @default(cuid(2))
    name                String @unique
    default             Boolean @default(false)
    owner               String
    created             DateTime @default(now())
    updated             DateTime @default(now()) @updatedAt

    grants              grants[]
    permissions         permissions[]
}

model grants {
    id                  String @default(cuid(2))
    user                String
    roleRef             roles @relation(fields: [role], references: [name], onDelete: Cascade)
    role                String
    owner               String
    created             DateTime @default(now())
    updated             DateTime @default(now()) @updatedAt

    @@unique([user, role])
}

model permissions {
    id                  String @default(cuid(2))
    roleRef             roles @relation(fields: [role], references: [name], onDelete: Cascade)
    role                String
    resource            String
    action              String
    attributes          String @default("*")
    owner               String
    created             DateTime @default(now())
    updated             DateTime @default(now()) @updatedAt

    @@unique([role, resource, action, attributes])
}

model litestream_lock {
    id                  Int @id

    @@map("_litestream_lock")
}

model litestream_seq {
    id                  Int @id @default(autoincrement())
    seq                 Int?

    @@map("_litestream_seq")
}
